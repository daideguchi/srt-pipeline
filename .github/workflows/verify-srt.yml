name: verify-srt
on:
  pull_request:
    branches: [ main ]
  workflow_dispatch:

jobs:
  verify:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          lfs: true
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"
      - name: Install dependencies
        run: |
          pip install -r requirements.txt || echo "No requirements.txt found"
          # Install ffprobe for audio duration check
          sudo apt-get update
          sudo apt-get install -y ffmpeg
      - name: Verify sync precision (‚â§ 0.050s)
        run: |
          echo "üîç Verifying subtitle synchronization precision..."
          python3 scripts/check_durations.py \
            --audio audio/voice.wav \
            --srt subs/final_production.srt
          echo "‚úÖ Sync verification completed"
      - name: Check quality standards
        run: |
          echo "üìä Quality standards check:"
          echo "- Target: diff ‚â§ 0.050s"
          echo "- CPS limit: ‚â§ 17.0"
          echo "- Min duration: ‚â• 1.2s"
          echo "- Min gap: ‚â• 0.12s"
          echo "- Max line length: ‚â§ 36 chars"
          echo "- Max lines per cue: 2"