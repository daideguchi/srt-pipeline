name: verify-srt
on:
  pull_request:
    branches: [ main ]
  workflow_dispatch:

jobs:
  verify:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: "3.11"
      - name: Verify sync (<= 0.050s) using JSON audio length
        run: |
          echo "🔍 Verifying subtitle synchronization precision..."
          python3 scripts/check_durations.py \
            --audio_json reports/audio_peaks.json \
            --srt subs/final_production.srt
          echo "✅ Sync verification completed"
      - name: Check quality standards
        run: |
          echo "📊 Quality standards check:"
          echo "- Target: diff ≤ 0.050s"
          echo "- CPS limit: ≤ 17.0"
          echo "- Min duration: ≥ 1.2s"
          echo "- Min gap: ≥ 0.12s"
          echo "- Max line length: ≤ 36 chars"
          echo "- Max lines per cue: 2"